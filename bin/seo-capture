#!/usr/local/bin/python3
import sys
import argparse
import zmq
import os
import json
import sys
sys.path.append("..")
import Session

# Create argument parser
parser = argparse.ArgumentParser(description='Submit imaging requests to the Stone Edge Observatory')
parser.add_argument('--targets', '-t', help="The list of targets to be imaged", required=True,
                    type=str, nargs='+' )
parser.add_argument('--exposure_time', '-e', help="The exposure time for each frame",
                    default=60, type=float)
parser.add_argument('--exposure_count', '-c', help="The total exposure count for each filter",
                    default=1, type=int)
parser.add_argument('--filters', '-f', help="The list of filters to be used for each exposure",
                    default="clear", type=str)
parser.add_argument('--binning', '-b', help="The desired CCD binning",
                    default=2, type=int)

# Parse arguments
args = parser.parse_args()

# Create a new imaging session
s = Session.Session(targets = args.targets,
                    exposure_time = args.exposure_time,
                    exposure_count = args.exposure_count,
                    filters = args.filters,
                    binning = args.binning,
                    user = os.environ['USER'])

# execute the session
s.execute()

